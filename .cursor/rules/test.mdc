---
description: æ¸¬è©¦æ ¸å¿ƒéœ€æ±‚æ˜¯å¦å®Œæˆï¼›æ¸¬è©¦PRDæ˜¯å¦å®Œæˆ - è‡ªå‹•èª¿ç”¨å ´æ™¯ï¼šPRDéœ€æ±‚æ¸¬è©¦ã€æ ¸å¿ƒåŠŸèƒ½æ¸¬è©¦ã€PRDåŠŸèƒ½é©—æ”¶æ¸¬è©¦ã€PRDæ€§èƒ½åŸºæº–æ¸¬è©¦ã€PRDç”¨æˆ¶é«”é©—æ¸¬è©¦ã€PRDæ¬Šé™å®‰å…¨æ¸¬è©¦ã€PRDå°æ¯”æ¸¬è©¦å ±å‘Šã€PRDæ¸¬è©¦çµæœéŒ„å…¥ã€PRDå¯¦ç¾é€²åº¦è¨˜éŒ„ã€PRDéœ€æ±‚è§£æã€PRDæ¸¬è©¦æ¡ˆä¾‹ç”Ÿæˆã€PRDåŠŸèƒ½æ¸¬è©¦åŸ·è¡Œã€PRDæ€§èƒ½æ¸¬è©¦åŸ·è¡Œã€PRDç”¨æˆ¶é«”é©—æ¸¬è©¦åŸ·è¡Œã€PRDæ¬Šé™æ¸¬è©¦åŸ·è¡Œã€PRDæ•´åˆæ¸¬è©¦ã€PRDæ¸¬è©¦åˆ†é¡ã€PRDæ¸¬è©¦æ¨™æº–ã€PRDæ¸¬è©¦è©•ä¼°ã€PRDæ¸¬è©¦è¦†è“‹ç‡ã€PRDæ¸¬è©¦é€šéç‡ã€PRDæ¸¬è©¦è³ªé‡è©•åˆ†ã€PRDæ¸¬è©¦çµæœéŒ„å…¥æ©Ÿåˆ¶ã€PRDæ¸¬è©¦çµæœéŒ„å…¥è¦ç¯„ã€PRDæ¸¬è©¦çµæœéŒ„å…¥æµç¨‹ã€result.mdæ–‡ä»¶éŒ„å…¥ã€PRDæ¸¬è©¦é€²åº¦è¿½è¹¤ã€PRDæ¸¬è©¦æ›´æ–°æ­·å²ã€PRDæ¸¬è©¦åŸ·è¡Œæ‘˜è¦ã€PRDè©³ç´°æ¸¬è©¦çµæœã€PRDéœ€æ±‚é©—è­‰ç‹€æ…‹ã€PRDæ¸¬è©¦ç™¼ç¾èˆ‡å»ºè­°ã€PRDæ¸¬è©¦é€²åº¦è¿½è¹¤ã€PRDæ¸¬è©¦æ›´æ–°æ­·å²ã€PRDè‡ªå‹•åŒ–æ¸¬è©¦è§¸ç™¼ã€PRDæ¸¬è©¦è®Šæ›´ç›£æ§ã€PRDæ¸¬è©¦è®Šæ›´æª¢æ¸¬ã€PRDæ–‡ä»¶è®Šæ›´ç›£æ§ã€PRDå®šæœŸæ¸¬è©¦å®‰æ’ã€PRDæ¸¬è©¦é…ç½®ã€PRDæ¸¬è©¦é©—æ”¶æ¨™æº–ã€PRDåŠŸèƒ½é©—æ”¶ã€PRDæ€§èƒ½é©—æ”¶ã€PRDç”¨æˆ¶é«”é©—é©—æ”¶ã€PRDå®‰å…¨é©—æ”¶ã€PRDè¦†è“‹ç‡é©—æ”¶ã€PRDé©…å‹•åŸå‰‡ã€PRDéœ€æ±‚å°æ¯”ã€PRDå¯¦ç¾é©—è­‰ã€PRDé€²åº¦è¿½è¹¤ã€PRDæ¸¬è©¦è³ªé‡æ¨™æº–ã€PRDæ¸¬è©¦æº–ç¢ºæ€§ã€PRDæ¸¬è©¦å®Œæ•´æ€§ã€PRDæ¸¬è©¦å¯é æ€§ã€PRDæ¸¬è©¦åŠæ™‚æ€§ã€PRDæŒçºŒç›£æ§ã€PRDå®šæœŸè©•ä¼°ã€PRDå‹•æ…‹èª¿æ•´ã€PRDåé¥‹å¾ªç’°ã€PRDæ¸¬è©¦æ”¹é€²æ©Ÿåˆ¶ã€PRDæ¸¬è©¦åŸ·è¡Œå™¨ã€PRDæ¸¬è©¦ç›£æ§å™¨ã€PRDæ¸¬è©¦è§¸ç™¼å™¨ã€PRDæ¸¬è©¦è©•ä¼°å™¨ã€PRDæ¸¬è©¦è¨˜éŒ„å™¨ã€PRDæ¸¬è©¦åˆ†æå™¨ã€PRDæ¸¬è©¦å ±å‘Šç”Ÿæˆå™¨ã€PRDæ¸¬è©¦çµæœåˆ†æã€PRDæ¸¬è©¦å•é¡Œè¨ºæ–·ã€PRDæ¸¬è©¦æ”¹é€²å»ºè­°ã€PRDæ¸¬è©¦å¯¦æ–½è¨ˆåŠƒã€PRDæ¸¬è©¦é¢¨éšªè©•ä¼°ã€PRDæ¸¬è©¦æˆåŠŸæŒ‡æ¨™ã€PRDæ¸¬è©¦è³ªé‡æª¢æŸ¥ã€PRDæ¸¬è©¦å®Œæ•´æ€§è©•ä¼°ã€PRDæ¸¬è©¦å¯é æ€§åˆ†æã€PRDæ¸¬è©¦æº–ç¢ºæ€§é©—è­‰ã€PRDæ¸¬è©¦ä¸€è‡´æ€§æª¢æŸ¥ã€PRDæ¸¬è©¦é‡è¤‡æ€§åˆ†æã€PRDæ¸¬è©¦æ•ˆç‡è©•ä¼°ã€PRDæ¸¬è©¦æ•ˆæœåˆ†æã€PRDæ¸¬è©¦åƒ¹å€¼è©•ä¼°ã€PRDæ¸¬è©¦æˆæœ¬åˆ†æã€PRDæ¸¬è©¦æ”¶ç›Šè©•ä¼°ã€PRDæ¸¬è©¦ROIåˆ†æã€PRDæ¸¬è©¦æŠ•è³‡å›å ±è©•ä¼°ã€PRDæ¸¬è©¦æ•ˆç›Šåˆ†æã€PRDæ¸¬è©¦å½±éŸ¿è©•ä¼°ã€PRDæ¸¬è©¦çµæœè§£é‡‹ã€PRDæ¸¬è©¦æ•¸æ“šå¯è¦–åŒ–ã€PRDæ¸¬è©¦è¶¨å‹¢åˆ†æã€PRDæ¸¬è©¦æ¨¡å¼è­˜åˆ¥ã€PRDæ¸¬è©¦ç•°å¸¸æª¢æ¸¬ã€PRDæ¸¬è©¦ç•°å¸¸è™•ç†ã€PRDæ¸¬è©¦ç•°å¸¸é é˜²ã€PRDæ¸¬è©¦ç•°å¸¸ç›£æ§ã€PRDæ¸¬è©¦ç•°å¸¸å ±å‘Šã€PRDæ¸¬è©¦ç•°å¸¸è¿½è¹¤ã€PRDæ¸¬è©¦ç•°å¸¸è§£æ±ºã€PRDæ¸¬è©¦ç•°å¸¸å„ªåŒ–ã€PRDæ¸¬è©¦ç•°å¸¸æ”¹é€²ã€PRDæ¸¬è©¦ç•°å¸¸ç®¡ç†ã€PRDæ¸¬è©¦ç•°å¸¸æ§åˆ¶ã€PRDæ¸¬è©¦ç•°å¸¸é˜²ç¯„ã€PRDæ¸¬è©¦ç•°å¸¸é è­¦ã€PRDæ¸¬è©¦ç•°å¸¸éŸ¿æ‡‰ã€PRDæ¸¬è©¦ç•°å¸¸æ¢å¾©ã€PRDæ¸¬è©¦ç•°å¸¸ä¿®å¾©ã€PRDæ¸¬è©¦ç•°å¸¸å‡ç´šã€PRDæ¸¬è©¦ç•°å¸¸é™ç´šã€PRDæ¸¬è©¦ç•°å¸¸åˆ‡æ›ã€PRDæ¸¬è©¦ç•°å¸¸éš”é›¢ã€PRDæ¸¬è©¦ç•°å¸¸ä¸¦è¡Œã€PRDæ¸¬è©¦ç•°å¸¸ä¸²è¡Œã€PRDæ¸¬è©¦ç•°å¸¸ç•°æ­¥ã€PRDæ¸¬è©¦ç•°å¸¸åŒæ­¥ã€PRDæ¸¬è©¦ç•°å¸¸ä¸¦ç™¼ã€PRDæ¸¬è©¦ç•°å¸¸åˆ†ä½ˆã€PRDæ¸¬è©¦ç•°å¸¸é›†ä¸­ã€PRDæ¸¬è©¦ç•°å¸¸åˆ†æ•£ã€PRDæ¸¬è©¦ç•°å¸¸èšåˆã€PRDæ¸¬è©¦ç•°å¸¸åˆ†è§£ã€PRDæ¸¬è©¦ç•°å¸¸çµ„åˆã€PRDæ¸¬è©¦ç•°å¸¸æ‹†åˆ†ã€PRDæ¸¬è©¦ç•°å¸¸åˆä½µã€PRDæ¸¬è©¦ç•°å¸¸åˆ†é›¢ã€PRDæ¸¬è©¦ç•°å¸¸é€£æ¥ã€PRDæ¸¬è©¦ç•°å¸¸æ–·é–‹ã€PRDæ¸¬è©¦ç•°å¸¸å•Ÿå‹•ã€PRDæ¸¬è©¦ç•°å¸¸åœæ­¢ã€PRDæ¸¬è©¦ç•°å¸¸æš«åœã€PRDæ¸¬è©¦ç•°å¸¸æ¢å¾©ã€PRDæ¸¬è©¦ç•°å¸¸é‡å•Ÿã€PRDæ¸¬è©¦ç•°å¸¸é‡ç½®ã€PRDæ¸¬è©¦ç•°å¸¸æ¸…é™¤ã€PRDæ¸¬è©¦ç•°å¸¸æ¸…ç†ã€PRDæ¸¬è©¦ç•°å¸¸æ•´ç†ã€PRDæ¸¬è©¦ç•°å¸¸æ­¸æª”
globs: 
alwaysApply: false
---
globs: 
alwaysApply: false
---
## ğŸ“‹ æ¨™æº–åŒ–æ¸¬è©¦æµç¨‹

### 1.1 PRD é©…å‹•æ¸¬è©¦æµç¨‹
```python
# PRD é©…å‹•æ¸¬è©¦æµç¨‹å®šç¾©
PRD_DRIVEN_TEST_WORKFLOW = {
    "step_1": "è§£æPRDéœ€æ±‚æ–‡æª”ï¼Œæå–åŠŸèƒ½è¦æ ¼",
    "step_2": "åŸºæ–¼PRDç”Ÿæˆå°æ‡‰æ¸¬è©¦æ¡ˆä¾‹", 
    "step_3": "åŸ·è¡ŒPRDåŠŸèƒ½é©—æ”¶æ¸¬è©¦",
    "step_4": "åŸ·è¡ŒPRDæ€§èƒ½åŸºæº–æ¸¬è©¦",
    "step_5": "åŸ·è¡ŒPRDç”¨æˆ¶é«”é©—æ¸¬è©¦",
    "step_6": "åŸ·è¡ŒPRDæ¬Šé™å®‰å…¨æ¸¬è©¦",
    "step_7": "ç”ŸæˆPRDå°æ¯”æ¸¬è©¦å ±å‘Š",
    "step_8": "è‡ªå‹•éŒ„å…¥ result.md æ–‡ä»¶",
    "step_9": "æ›´æ–°PRDå¯¦ç¾é€²åº¦è¨˜éŒ„"
}
```

### 1.2 PRD æ¸¬è©¦çµæœéŒ„å…¥æ©Ÿåˆ¶
```python
# utils/prd_test_result_recorder.py
class PRDTestResultRecorder:
    """PRD æ¸¬è©¦çµæœéŒ„å…¥å™¨ - è‡ªå‹•éŒ„å…¥ result.md æ–‡ä»¶"""
    
    def __init__(self, memory_bank_path: str = "memory_bank"):
        self.memory_bank_path = memory_bank_path
        self.result_file_path = f"{memory_bank_path}/result.md"
    
    def record_test_results_to_result_md(self, test_report: PRDTestReport) -> bool:
        """å°‡æ¸¬è©¦çµæœéŒ„å…¥åˆ° result.md æ–‡ä»¶"""
        try:
            # è®€å–ç¾æœ‰çš„result.mdæ–‡æª”
            result_content = self._read_existing_result_md()
            
            # è§£æresult.mdå…§å®¹çµæ§‹
            result_sections = self._parse_result_sections(result_content)
            
            # æ·»åŠ æ–°çš„PRDæ¸¬è©¦çµæœè¨˜éŒ„
            updated_result_content = self._add_prd_test_results(
                result_sections, test_report
            )
            
            # ä¿å­˜æ›´æ–°å¾Œçš„result.mdæ–‡æª”
            self._save_updated_result_md(updated_result_content)
            
            print(f"âœ… PRD æ¸¬è©¦çµæœå·²éŒ„å…¥åˆ°: {self.result_file_path}")
            return True
        except Exception as e:
            print(f"âŒ PRD æ¸¬è©¦çµæœéŒ„å…¥å¤±æ•—: {e}")
            return False
    
    def _read_existing_result_md(self) -> str:
        """è®€å–ç¾æœ‰çš„result.mdæ–‡æª”"""
        if os.path.exists(self.result_file_path):
            with open(self.result_file_path, "r", encoding="utf-8") as f:
                return f.read()
        else:
            return self._create_default_result_template()
    
    def _create_default_result_template(self) -> str:
        """å‰µå»ºé»˜èªresult.mdæ¨¡æ¿"""
        return """# ğŸ“Š æ¸¬è©¦çµæœè¨˜éŒ„

## ğŸ¯ é …ç›®æ¦‚è¿°
- **é …ç›®åç¨±**: Discord ADR Bot
- **ç‰ˆæœ¬**: 1.0.0
- **æœ€å¾Œæ›´æ–°**: {timestamp}

## ğŸ§ª PRD æ¸¬è©¦çµæœè¨˜éŒ„

### æ¸¬è©¦åŸ·è¡Œæ‘˜è¦
| æ¸¬è©¦é¡å‹ | åŸ·è¡Œæ™‚é–“ | æ¸¬è©¦ç‹€æ…‹ | è¦†è“‹ç‡ | é€šéç‡ |
|----------|----------|----------|--------|--------|

### è©³ç´°æ¸¬è©¦çµæœ
{detailed_test_results}

### PRD éœ€æ±‚é©—è­‰ç‹€æ…‹
{prd_verification_status}

### æ¸¬è©¦ç™¼ç¾èˆ‡å»ºè­°
{test_findings_and_recommendations}

## ğŸ“ˆ æ¸¬è©¦é€²åº¦è¿½è¹¤
### å·²å®Œæˆæ¸¬è©¦
{completed_tests}

### é€²è¡Œä¸­æ¸¬è©¦
{in_progress_tests}

### å¾…åŸ·è¡Œæ¸¬è©¦
{pending_tests}

## ğŸ”„ æ›´æ–°æ­·å²
{update_history}
"""
    
    def _parse_result_sections(self, result_content: str) -> dict:
        """è§£æresult.mdæ–‡æª”çš„å„å€‹ç« ç¯€"""
        sections = {
            "overview": "",
            "test_summary": "",
            "detailed_results": "",
            "prd_verification": "",
            "findings": "",
            "progress_tracking": "",
            "update_history": ""
        }
        
        # å¯¦ç¾result.mdç« ç¯€è§£æé‚è¼¯
        lines = result_content.split('\n')
        current_section = None
        
        for line in lines:
            if line.startswith('## ğŸ¯ é …ç›®æ¦‚è¿°'):
                current_section = 'overview'
            elif line.startswith('## ğŸ§ª PRD æ¸¬è©¦çµæœè¨˜éŒ„'):
                current_section = 'test_results'
            elif line.startswith('### æ¸¬è©¦åŸ·è¡Œæ‘˜è¦'):
                current_section = 'test_summary'
            elif line.startswith('### è©³ç´°æ¸¬è©¦çµæœ'):
                current_section = 'detailed_results'
            elif line.startswith('### PRD éœ€æ±‚é©—è­‰ç‹€æ…‹'):
                current_section = 'prd_verification'
            elif line.startswith('### æ¸¬è©¦ç™¼ç¾èˆ‡å»ºè­°'):
                current_section = 'findings'
            elif line.startswith('## ğŸ“ˆ æ¸¬è©¦é€²åº¦è¿½è¹¤'):
                current_section = 'progress_tracking'
            elif line.startswith('## ğŸ”„ æ›´æ–°æ­·å²'):
                current_section = 'update_history'
            else:
                if current_section:
                    if current_section == 'overview':
                        sections['overview'] += line + '\n'
                    elif current_section == 'test_summary':
                        sections['test_summary'] += line + '\n'
                    elif current_section == 'detailed_results':
                        sections['detailed_results'] += line + '\n'
                    elif current_section == 'prd_verification':
                        sections['prd_verification'] += line + '\n'
                    elif current_section == 'findings':
                        sections['findings'] += line + '\n'
                    elif current_section == 'progress_tracking':
                        sections['progress_tracking'] += line + '\n'
                    elif current_section == 'update_history':
                        sections['update_history'] += line + '\n'
        
        return sections
    
    def _add_prd_test_results(self, result_sections: dict, test_report: PRDTestReport) -> str:
        """æ·»åŠ PRDæ¸¬è©¦çµæœåˆ°result.md"""
        timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        
        # ç”Ÿæˆæ¸¬è©¦åŸ·è¡Œæ‘˜è¦
        test_summary = self._generate_test_summary_table(test_report)
        
        # ç”Ÿæˆè©³ç´°æ¸¬è©¦çµæœ
        detailed_results = self._generate_detailed_test_results(test_report)
        
        # ç”ŸæˆPRDéœ€æ±‚é©—è­‰ç‹€æ…‹
        prd_verification = self._generate_prd_verification_status(test_report)
        
        # ç”Ÿæˆæ¸¬è©¦ç™¼ç¾èˆ‡å»ºè­°
        findings = self._generate_test_findings_and_recommendations(test_report)
        
        # ç”Ÿæˆæ¸¬è©¦é€²åº¦è¿½è¹¤
        progress_tracking = self._generate_test_progress_tracking(test_report)
        
        # ç”Ÿæˆæ›´æ–°æ­·å²
        update_history = self._generate_test_update_history(test_report)
        
        # ç”Ÿæˆæ›´æ–°å¾Œçš„result.mdå…§å®¹
        updated_content = f"""# ğŸ“Š æ¸¬è©¦çµæœè¨˜éŒ„

## ğŸ¯ é …ç›®æ¦‚è¿°
- **é …ç›®åç¨±**: Discord ADR Bot
- **ç‰ˆæœ¬**: 1.0.0
- **æœ€å¾Œæ›´æ–°**: {timestamp}

## ğŸ§ª PRD æ¸¬è©¦çµæœè¨˜éŒ„

### æ¸¬è©¦åŸ·è¡Œæ‘˜è¦
{test_summary}

### è©³ç´°æ¸¬è©¦çµæœ
{detailed_results}

### PRD éœ€æ±‚é©—è­‰ç‹€æ…‹
{prd_verification}

### æ¸¬è©¦ç™¼ç¾èˆ‡å»ºè­°
{findings}

## ğŸ“ˆ æ¸¬è©¦é€²åº¦è¿½è¹¤
{progress_tracking}

## ğŸ”„ æ›´æ–°æ­·å²
{update_history}
"""
        
        return updated_content
    
    def _generate_test_summary_table(self, test_report: PRDTestReport) -> str:
        """ç”Ÿæˆæ¸¬è©¦åŸ·è¡Œæ‘˜è¦è¡¨æ ¼"""
        table_content = """| æ¸¬è©¦é¡å‹ | åŸ·è¡Œæ™‚é–“ | æ¸¬è©¦ç‹€æ…‹ | è¦†è“‹ç‡ | é€šéç‡ |
|----------|----------|----------|--------|--------|"""
        
        for test_type, result in test_report.summary.items():
            if test_type in ['functional', 'performance', 'ux', 'permission']:
                status_emoji = "âœ…" if result['status'] == 'passed' else "âŒ" if result['status'] == 'failed' else "ğŸŸ¡"
                table_content += f"\n| {test_type.title()} | {test_report.generated_at.strftime('%Y-%m-%d %H:%M:%S')} | {status_emoji} | {result.get('coverage', 0):.1f}% | {result.get('pass_rate', 0):.1f}% |"
        
        return table_content
    
    def _generate_detailed_test_results(self, test_report: PRDTestReport) -> str:
        """ç”Ÿæˆè©³ç´°æ¸¬è©¦çµæœ"""
        results = []
        
        for category, results_data in test_report.detailed_results.items():
            results.append(f"#### {category}")
            for test_name, test_result in results_data.items():
                status_emoji = "âœ…" if test_result['status'] == 'passed' else "âŒ"
                results.append(f"- {status_emoji} {test_name}: {test_result['message']}")
            results.append("")
        
        return "\n".join(results)
    
    def _generate_prd_verification_status(self, test_report: PRDTestReport) -> str:
        """ç”ŸæˆPRDéœ€æ±‚é©—è­‰ç‹€æ…‹"""
        verification_status = []
        
        for req_id, result in test_report.all_requirements.items():
            status_emoji = "âœ…" if result['status'] == 'passed' else "âŒ" if result['status'] == 'failed' else "ğŸŸ¡"
            verification_status.append(f"- {status_emoji} **{req_id}**: {result['description']} - {result['status']}")
        
        return "\n".join(verification_status) if verification_status else "- æš«ç„¡PRDéœ€æ±‚é©—è­‰è¨˜éŒ„"
    
    def _generate_test_findings_and_recommendations(self, test_report: PRDTestReport) -> str:
        """ç”Ÿæˆæ¸¬è©¦ç™¼ç¾èˆ‡å»ºè­°"""
        findings = []
        
        # åˆ†ææ¸¬è©¦çµæœä¸¦ç”Ÿæˆç™¼ç¾
        if test_report.summary.get('overall_status') == 'needs_improvement':
            findings.append("- ğŸ” **ç™¼ç¾**: æ•´é«”æ¸¬è©¦é€šéç‡è¼ƒä½ï¼Œéœ€è¦æ”¹é€²")
            findings.append("- ğŸ’¡ **å»ºè­°**: å„ªå…ˆä¿®å¾©å¤±æ•—çš„æ¸¬è©¦æ¡ˆä¾‹")
        
        if test_report.summary.get('coverage_percentage', 0) < 80:
            findings.append("- ğŸ” **ç™¼ç¾**: æ¸¬è©¦è¦†è“‹ç‡ä¸è¶³")
            findings.append("- ğŸ’¡ **å»ºè­°**: å¢åŠ æ¸¬è©¦æ¡ˆä¾‹ä»¥æé«˜è¦†è“‹ç‡")
        
        # æ·»åŠ å…·é«”çš„æ¸¬è©¦ç™¼ç¾
        for category, results in test_report.detailed_results.items():
            failed_tests = [name for name, result in results.items() if result['status'] == 'failed']
            if failed_tests:
                findings.append(f"- ğŸ” **{category}ç™¼ç¾**: {len(failed_tests)}å€‹æ¸¬è©¦å¤±æ•—")
                findings.append(f"- ğŸ’¡ **å»ºè­°**: ä¿®å¾© {', '.join(failed_tests[:3])} ç­‰é—œéµæ¸¬è©¦")
        
        return "\n".join(findings) if findings else "- æš«ç„¡ç‰¹æ®Šç™¼ç¾"
    
    def _generate_test_progress_tracking(self, test_report: PRDTestReport) -> str:
        """ç”Ÿæˆæ¸¬è©¦é€²åº¦è¿½è¹¤"""
        completed = []
        in_progress = []
        pending = []
        
        for req_id, result in test_report.all_requirements.items():
            if result['status'] == 'completed':
                completed.append(f"- {req_id}: {result['description']}")
            elif result['status'] == 'in_progress':
                in_progress.append(f"- {req_id}: {result['description']}")
            else:
                pending.append(f"- {req_id}: {result['description']}")
        
        content = "### å·²å®Œæˆæ¸¬è©¦\n"
        content += "\n".join(completed) if completed else "- æš«ç„¡å·²å®Œæˆæ¸¬è©¦\n"
        
        content += "\n### é€²è¡Œä¸­æ¸¬è©¦\n"
        content += "\n".join(in_progress) if in_progress else "- æš«ç„¡é€²è¡Œä¸­æ¸¬è©¦\n"
        
        content += "\n### å¾…åŸ·è¡Œæ¸¬è©¦\n"
        content += "\n".join(pending) if pending else "- æš«ç„¡å¾…åŸ·è¡Œæ¸¬è©¦\n"
        
        return content
    
    def _generate_test_update_history(self, test_report: PRDTestReport) -> str:
        """ç”Ÿæˆæ¸¬è©¦æ›´æ–°æ­·å²"""
        timestamp = test_report.generated_at.strftime("%Y-%m-%d %H:%M:%S")
        
        return f"""### {timestamp}
- åŸ·è¡ŒPRDé©…å‹•æ¸¬è©¦
- æ¸¬è©¦è¦†è“‹ç‡: {test_report.summary.get('coverage_percentage', 0):.1f}%
- æ¸¬è©¦é€šéç‡: {test_report.summary.get('pass_rate', 0):.1f}%
- æ•´é«”ç‹€æ…‹: {test_report.summary.get('overall_status', 'unknown')}

"""
    
    def _save_updated_result_md(self, updated_content: str):
        """ä¿å­˜æ›´æ–°å¾Œçš„result.mdæ–‡æª”"""
        os.makedirs(self.memory_bank_path, exist_ok=True)
        with open(self.result_file_path, "w", encoding="utf-8") as f:
            f.write(updated_content)
```

### 1.3 PRD æ¸¬è©¦çµæœéŒ„å…¥è¦ç¯„
```python
# PRD æ¸¬è©¦çµæœéŒ„å…¥è¦ç¯„
PRD_TEST_RECORDING_SPECIFICATION = {
    "target_file": "result.md",                   # ç›®æ¨™æ–‡ä»¶
    "file_path": "memory_bank/result.md",        # æ–‡ä»¶è·¯å¾‘
    "recording_strategy": "append_update",        # è¿½åŠ æ›´æ–°ç­–ç•¥
    "backup_strategy": "version_control",         # ç‰ˆæœ¬æ§åˆ¶å‚™ä»½
    "preserve_structure": True,                   # ä¿æŒæ–‡æª”çµæ§‹
    "add_test_summary": True,                     # æ·»åŠ æ¸¬è©¦æ‘˜è¦
    "record_verification_status": True,           # è¨˜éŒ„é©—è­‰ç‹€æ…‹
    "track_progress": True                        # è¿½è¹¤é€²åº¦
}

# PRD æ¸¬è©¦çµæœéŒ„å…¥æµç¨‹
PRD_TEST_RECORDING_PROCESS = {
    "step_1": "è®€å–ç¾æœ‰çš„ result.md æ–‡ä»¶",
    "step_2": "è§£æresult.mdæ–‡æª”çµæ§‹",
    "step_3": "åˆ†ææ¸¬è©¦çµæœ",
    "step_4": "è¨˜éŒ„PRDéœ€æ±‚é©—è­‰ç‹€æ…‹",
    "step_5": "æ·»åŠ æ¸¬è©¦çµæœæ‘˜è¦",
    "step_6": "æ›´æ–°æ¸¬è©¦é€²åº¦è¿½è¹¤",
    "step_7": "ä¿å­˜æ›´æ–°å¾Œçš„ result.md",
    "step_8": "è¨˜éŒ„æ›´æ–°æ­·å²"
}
```

---

## ğŸ¤– AI PRD æ¸¬è©¦åŸ·è¡Œå™¨

### 2.1 PRD é©…å‹•æ¸¬è©¦åŸ·è¡Œå™¨
```python
# utils/ai_prd_test_runner.py
class AIPRDTestRunner:
    """AI PRD é©…å‹•æ¸¬è©¦åŸ·è¡Œå™¨"""
    
    def __init__(self, prd_file_path: str = "memory_bank/prd.md"):
        self.prd_file_path = prd_file_path
        self.test_results = {}
        self.recorder = PRDTestResultRecorder()
    
    def run_prd_driven_tests(self) -> PRDTestReport:
        """åŸ·è¡ŒPRDé©…å‹•æ¸¬è©¦æµç¨‹"""
        print("ğŸ§ª é–‹å§‹åŸ·è¡Œ AI PRD é©…å‹•æ¸¬è©¦...")
        
        # 1. PRD éœ€æ±‚è§£æ
        prd_requirements = self._parse_prd_requirements()
        
        # 2. åŸºæ–¼PRDç”Ÿæˆæ¸¬è©¦æ¡ˆä¾‹
        prd_test_cases = self._generate_prd_test_cases(prd_requirements)
        
        # 3. PRD åŠŸèƒ½æ¸¬è©¦
        prd_functional_results = self._run_prd_functional_tests(prd_test_cases)
        
        # 4. PRD æ€§èƒ½æ¸¬è©¦
        prd_performance_results = self._run_prd_performance_tests(prd_test_cases)
        
        # 5. PRD ç”¨æˆ¶é«”é©—æ¸¬è©¦
        prd_ux_results = self._run_prd_user_experience_tests(prd_test_cases)
        
        # 6. PRD æ¬Šé™æ¸¬è©¦
        prd_permission_results = self._run_prd_permission_tests(prd_test_cases)
        
        # 7. ç”ŸæˆPRDå°æ¯”å ±å‘Š
        prd_comprehensive_report = PRDTestReport(
            prd_requirements=prd_requirements,
            prd_test_cases=prd_test_cases,
            prd_functional_results=prd_functional_results,
            prd_performance_results=prd_performance_results,
            prd_ux_results=prd_ux_results,
            prd_permission_results=prd_permission_results
        )
        
        # 8. è‡ªå‹•éŒ„å…¥result.mdæ–‡æª”
        self.recorder.record_test_results_to_result_md(prd_comprehensive_report)
        
        return prd_comprehensive_report
    
    def _parse_prd_requirements(self) -> List[PRDRequirement]:
        """è§£æPRDéœ€æ±‚"""
        print("ğŸ“‹ è§£æPRDéœ€æ±‚æ–‡æª”...")
        # å¯¦ç¾PRDè§£æé‚è¼¯
        return []
    
    def _generate_prd_test_cases(self, prd_requirements: List[PRDRequirement]) -> List[PRDTestCase]:
        """åŸºæ–¼PRDç”Ÿæˆæ¸¬è©¦æ¡ˆä¾‹"""
        print("ğŸ“‹ åŸºæ–¼PRDç”Ÿæˆæ¸¬è©¦æ¡ˆä¾‹...")
        # å¯¦ç¾PRDæ¸¬è©¦æ¡ˆä¾‹ç”Ÿæˆé‚è¼¯
        return []
    
    def _run_prd_functional_tests(self, prd_test_cases: List[PRDTestCase]) -> Dict[str, PRDTestResult]:
        """åŸ·è¡ŒPRDåŠŸèƒ½æ¸¬è©¦"""
        print("ğŸ”§ åŸ·è¡ŒPRDåŠŸèƒ½æ¸¬è©¦...")
        results = {}
        # å¯¦ç¾PRDåŠŸèƒ½æ¸¬è©¦é‚è¼¯
        return results
    
    def _run_prd_performance_tests(self, prd_test_cases: List[PRDTestCase]) -> Dict[str, PRDTestResult]:
        """åŸ·è¡ŒPRDæ€§èƒ½æ¸¬è©¦"""
        print("âš¡ åŸ·è¡ŒPRDæ€§èƒ½æ¸¬è©¦...")
        results = {}
        # å¯¦ç¾PRDæ€§èƒ½æ¸¬è©¦é‚è¼¯
        return results
    
    def _run_prd_user_experience_tests(self, prd_test_cases: List[PRDTestCase]) -> Dict[str, PRDTestResult]:
        """åŸ·è¡ŒPRDç”¨æˆ¶é«”é©—æ¸¬è©¦"""
        print("ğŸ‘¥ åŸ·è¡ŒPRDç”¨æˆ¶é«”é©—æ¸¬è©¦...")
        results = {}
        # å¯¦ç¾PRDç”¨æˆ¶é«”é©—æ¸¬è©¦é‚è¼¯
        return results
    
    def _run_prd_permission_tests(self, prd_test_cases: List[PRDTestCase]) -> Dict[str, PRDTestResult]:
        """åŸ·è¡ŒPRDæ¬Šé™æ¸¬è©¦"""
        print("ğŸ” åŸ·è¡ŒPRDæ¬Šé™æ¸¬è©¦...")
        results = {}
        # å¯¦ç¾PRDæ¬Šé™æ¸¬è©¦é‚è¼¯
        return results
```

---

## ğŸ“Š PRD æ¸¬è©¦åˆ†é¡èˆ‡æ¨™æº–

### 3.1 PRD æ¸¬è©¦åˆ†é¡æ¨™æº–
```python
# PRD é©…å‹•æ¸¬è©¦åˆ†é¡
PRD_DRIVEN_TEST_CATEGORIES = {
    "prd_functional": {
        "name": "PRD åŠŸèƒ½æ¸¬è©¦",
        "description": "é©—è­‰PRDä¸­å®šç¾©çš„åŠŸèƒ½æ˜¯å¦æ­£ç¢ºå¯¦ç¾",
        "priority": "high",
        "prd_coverage_target": 90
    },
    "prd_performance": {
        "name": "PRD æ€§èƒ½æ¸¬è©¦", 
        "description": "é©—è­‰PRDä¸­å®šç¾©çš„æ€§èƒ½è¦æ±‚æ˜¯å¦é”æˆ",
        "priority": "medium",
        "prd_coverage_target": 80
    },
    "prd_ux": {
        "name": "PRD ç”¨æˆ¶é«”é©—æ¸¬è©¦",
        "description": "é©—è­‰PRDä¸­å®šç¾©çš„ç”¨æˆ¶é«”é©—æ˜¯å¦è‰¯å¥½",
        "priority": "medium", 
        "prd_coverage_target": 85
    },
    "prd_permission": {
        "name": "PRD æ¬Šé™æ¸¬è©¦",
        "description": "é©—è­‰PRDä¸­å®šç¾©çš„æ¬Šé™ç³»çµ±æ˜¯å¦å®‰å…¨",
        "priority": "high",
        "prd_coverage_target": 95
    },
    "prd_integration": {
        "name": "PRD æ•´åˆæ¸¬è©¦",
        "description": "é©—è­‰PRDä¸­å®šç¾©çš„æ¨¡çµ„é–“å”ä½œæ˜¯å¦æ­£å¸¸",
        "priority": "high",
        "prd_coverage_target": 85
    }
}
```

### 3.2 PRD æ¸¬è©¦çµæœè©•ä¼°æ¨™æº–
```python
# PRD æ¸¬è©¦çµæœè©•ä¼°æ¨™æº–
PRD_TEST_RESULT_EVALUATION_STANDARDS = {
    "excellent": {
        "prd_coverage_percentage": ">= 90%",
        "prd_pass_rate": ">= 95%",
        "prd_quality_score": ">= 8.5",
        "status": "PRD å¯¦ç¾å„ªç§€"
    },
    "good": {
        "prd_coverage_percentage": ">= 80%",
        "prd_pass_rate": ">= 90%", 
        "prd_quality_score": ">= 7.0",
        "status": "PRD å¯¦ç¾è‰¯å¥½"
    },
    "acceptable": {
        "prd_coverage_percentage": ">= 70%",
        "prd_pass_rate": ">= 80%",
        "prd_quality_score": ">= 6.0", 
        "status": "PRD å¯¦ç¾å¯æ¥å—"
    },
    "needs_improvement": {
        "prd_coverage_percentage": "< 70%",
        "prd_pass_rate": "< 80%",
        "prd_quality_score": "< 6.0",
        "status": "PRD å¯¦ç¾éœ€è¦æ”¹é€²"
    }
}
```

---

## ğŸ”„ PRD æŒçºŒæ¸¬è©¦ç›£æ§

### 4.1 PRD è‡ªå‹•åŒ–æ¸¬è©¦è§¸ç™¼å™¨
```python
# utils/prd_automated_test_trigger.py
class PRDAutomatedTestTrigger:
    """PRD è‡ªå‹•åŒ–æ¸¬è©¦è§¸ç™¼å™¨"""
    
    def __init__(self):
        self.prd_test_runner = AIPRDTestRunner()
        self.prd_monitor = PRDChangeMonitor()
    
    def check_and_trigger_prd_tests(self):
        """æª¢æŸ¥ä¸¦è§¸ç™¼PRDæ¸¬è©¦"""
        if self.prd_monitor.detect_prd_changes():
            print("ğŸ”„ æª¢æ¸¬åˆ°PRDè®Šæ›´ï¼Œè§¸ç™¼è‡ªå‹•åŒ–PRDæ¸¬è©¦...")
            self.prd_test_runner.run_prd_driven_tests()
        else:
            print("âœ… ç„¡PRDè®Šæ›´ï¼Œè·³éæ¸¬è©¦")
    
    def schedule_periodic_prd_tests(self, interval_hours: int = 24):
        """å®‰æ’å®šæœŸPRDæ¸¬è©¦"""
        print(f"â° å®‰æ’æ¯ {interval_hours} å°æ™‚åŸ·è¡Œä¸€æ¬¡PRDæ¸¬è©¦")
        # å¯¦ç¾å®šæœŸPRDæ¸¬è©¦é‚è¼¯
```

### 4.2 PRD æ¸¬è©¦è®Šæ›´ç›£æ§å™¨
```python
# utils/prd_test_change_monitor.py
class PRDChangeMonitor:
    """PRD æ¸¬è©¦è®Šæ›´ç›£æ§å™¨"""
    
    def __init__(self):
        self.last_check = datetime.now()
        self.prd_change_detected = False
    
    def detect_prd_changes(self) -> bool:
        """æª¢æ¸¬PRDæ˜¯å¦æœ‰è®Šæ›´"""
        # å¯¦ç¾PRDè®Šæ›´æª¢æ¸¬é‚è¼¯
        return self.prd_change_detected
    
    def monitor_prd_file_changes(self, prd_file_paths: List[str]):
        """ç›£æ§PRDæ–‡ä»¶è®Šæ›´"""
        for prd_file_path in prd_file_paths:
            if self._has_prd_file_changed(prd_file_path):
                self.prd_change_detected = True
                break
    
    def _has_prd_file_changed(self, prd_file_path: str) -> bool:
        """æª¢æŸ¥PRDæ–‡ä»¶æ˜¯å¦è®Šæ›´"""
        # å¯¦ç¾PRDæ–‡ä»¶è®Šæ›´æª¢æ¸¬é‚è¼¯
        return False
```

---

## ğŸ“ PRD æ¸¬è©¦ä½¿ç”¨æŒ‡å—

### 5.1 å¿«é€Ÿé–‹å§‹
```bash
# 1. åŸ·è¡ŒPRDé©…å‹•æ¸¬è©¦
python -m utils.ai_prd_test_runner

# 2. æŸ¥çœ‹éŒ„å…¥çš„æ¸¬è©¦çµæœ
cat memory_bank/result.md

# 3. æª¢æŸ¥PRDæ¸¬è©¦ç‹€æ…‹
python -m utils.prd_test_status_checker
```

### 5.2 PRD æ¸¬è©¦é…ç½®
```python
# config/prd_test_config.py
PRD_TEST_CONFIG = {
    "prd_file": "memory_bank/prd.md",
    "result_file": "memory_bank/result.md",
    "recording_strategy": "append_update",
    "backup_strategy": "version_control",
    "prd_coverage_threshold": 80,
    "prd_pass_rate_threshold": 90,
    "prd_quality_score_threshold": 7.0
}
```

### 5.3 PRD é©—æ”¶æ¨™æº–
- **PRD åŠŸèƒ½é©—æ”¶**: æ‰€æœ‰PRDåŠŸèƒ½éœ€æ±‚æ­£ç¢ºå¯¦ç¾
- **PRD æ€§èƒ½é©—æ”¶**: ç¬¦åˆPRDæ€§èƒ½åŸºæº–è¦æ±‚
- **PRD ç”¨æˆ¶é«”é©—é©—æ”¶**: ç¬¦åˆPRDç”¨æˆ¶é«”é©—è¨­è¨ˆ
- **PRD å®‰å…¨é©—æ”¶**: ç¬¦åˆPRDå®‰å…¨è¦æ±‚
- **PRD è¦†è“‹ç‡é©—æ”¶**: PRDæ¸¬è©¦è¦†è“‹ç‡é”åˆ°80%ä»¥ä¸Š

---

## ğŸ¯ PRD æ¸¬è©¦æ ¸å¿ƒåŸå‰‡

### 6.1 PRD é©…å‹•åŸå‰‡
- **PRD å„ªå…ˆ**: æ‰€æœ‰æ¸¬è©¦å¿…é ˆåŸºæ–¼PRDæ–‡æª”é€²è¡Œ
- **éœ€æ±‚å°æ¯”**: æ¸¬è©¦çµæœå¿…é ˆèˆ‡PRDéœ€æ±‚é€²è¡Œå°æ¯”
- **å¯¦ç¾é©—è­‰**: é©—è­‰å¯¦éš›å¯¦ç¾æ˜¯å¦ç¬¦åˆPRDè¦æ ¼
- **é€²åº¦è¿½è¹¤**: è¿½è¹¤PRDå¯¦ç¾é€²åº¦å’Œæ¸¬è©¦è¦†è“‹ç‡

### 6.2 PRD æ¸¬è©¦è³ªé‡æ¨™æº–
- **æº–ç¢ºæ€§**: æ¸¬è©¦çµæœæº–ç¢ºåæ˜ PRDå¯¦ç¾ç‹€æ…‹
- **å®Œæ•´æ€§**: æ¸¬è©¦è¦†è“‹PRDä¸­å®šç¾©çš„æ‰€æœ‰éœ€æ±‚
- **å¯é æ€§**: æ¸¬è©¦çµæœç©©å®šå¯é ï¼Œå¯é‡è¤‡åŸ·è¡Œ
- **åŠæ™‚æ€§**: æ¸¬è©¦çµæœåŠæ™‚åæ˜ PRDå¯¦ç¾è®ŠåŒ–

### 6.3 PRD æ¸¬è©¦æ”¹é€²æ©Ÿåˆ¶
- **æŒçºŒç›£æ§**: æŒçºŒç›£æ§PRDå¯¦ç¾é€²åº¦
- **å®šæœŸè©•ä¼°**: å®šæœŸè©•ä¼°PRDæ¸¬è©¦è³ªé‡
- **å‹•æ…‹èª¿æ•´**: æ ¹æ“šPRDè®Šæ›´å‹•æ…‹èª¿æ•´æ¸¬è©¦ç­–ç•¥
- **åé¥‹å¾ªç’°**: å»ºç«‹PRDæ¸¬è©¦åé¥‹æ”¹é€²å¾ªç’°